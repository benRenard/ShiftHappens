% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/segmentation.R
\name{Segmentation_Engine}
\alias{Segmentation_Engine}
\title{Segmentation engine}
\source{
\url{https://theses.hal.science/tel-03211343}

\url{https://agupubs.onlinelibrary.wiley.com/doi/epdf/10.1029/2020WR028607}
}
\usage{
Segmentation_Engine(
  obs,
  time = 1:length(obs),
  u = 0 * obs,
  nS = 2,
  doQuickApprox = TRUE,
  nMin = ifelse(doQuickApprox, 3, 1),
  nSim = 500,
  varShift = FALSE,
  alpha = 0.1,
  mcmc_options = RBaM::mcmcOptions(),
  mcmc_cooking = RBaM::mcmcCooking(),
  temp.folder = file.path(tempdir(), "BaM"),
  mu_prior = list(NULL),
  ...
)
}
\arguments{
\item{obs}{real vector, observations}

\item{time}{vector, time in POSIXct, string or numeric format}

\item{u}{real vector, uncertainty in observations (as a standard deviation)}

\item{nS}{integer, number of segments}

\item{doQuickApprox}{logical, use quick approximation? see ?Segmentation_quickApprox}

\item{nMin}{integer, minimum number of observations by segment}

\item{nSim}{integer, number of Monte-Carlo simulated values for shift times. Only used when doQuickApprox=TRUE.}

\item{varShift}{logical, allow for a shifting variance? Only used when doQuickApprox=TRUE.}

\item{alpha}{real in (0;1), type-I error level of the underlying step-change test. Only used when doQuickApprox=TRUE.}

\item{mcmc_options}{mcmcOptions object, options used to generate MCMC samples (e.g. size and adaption tunings), see ?RBaM::mcmcOptions.
Only used when doQuickApprox=FALSE.}

\item{mcmc_cooking}{mcmcCooking object, options used to post-process MCMC samples (e.g. burn and slice), see ?RBaM::mcmcCooking.
Only used when doQuickApprox=FALSE.}

\item{temp.folder}{directory, temporary directory to write BaM computations.
Only used when doQuickApprox=FALSE.}

\item{mu_prior}{list, object describing prior knowledge on the mean of residuals for each segment.
Only used when doQuickApprox=FALSE.}

\item{...}{other arguments passed to RBaM::BaM.}
}
\value{
An object of class \code{\link[=simpleSegmentation]{simpleSegmentation()}}, containing the following fields:
\enumerate{
\item data: data frame, all data with their respective periods after segmentation
\item shifts: data frame, all detected shift times and their uncertainty in numeric or POSIXct format in UTC
\item mcmc: data frame, MCMC simulations
\item DIC: real, DIC estimation
\item origin.date: positive real or date, date describing origin of the segmentation for a sample. Useful for recursive segmentation.
}
}
\description{
Segmentation procedure for a \strong{known} given number of segments
}
\examples{
# Default segmentation using quick approximation
res=Segmentation_Engine(obs=RhoneRiverAMAX$H,time=RhoneRiverAMAX$Year,u=RhoneRiverAMAX$uH)
res$shifts
hist(res$mcmc$tau)
# Segmentation using BaM, allowing more than 2 segments and the use of priors
\dontrun{
# This line of code is wrapped in \dontrun{} since it relies
# on the installation of an executable with the package RBaM.
# See ?RBaM::downloadBaM for downloading and installing this executable.
prior=list(RBaM::parameter(name=paste0('mu1'),init=6,prior.dist='Gaussian',prior.par=c(6,5)),
           RBaM::parameter(name=paste0('mu2'),init=8,prior.dist='Gaussian',prior.par=c(8,2))))
res=Segmentation_Engine(obs=RhoneRiverAMAX$H,time=RhoneRiverAMAX$Year,u=RhoneRiverAMAX$uH,
     doQuickApprox=FALSE,nS=3,mu_prior=prior)
}
}
